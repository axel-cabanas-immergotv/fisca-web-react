<!-- Permission View Modal -->
<div class="modal fade" 
     x-show="permissionsModule.showPermissionViewModal" 
     x-transition:enter="fade-in" 
     x-transition:leave="fade-out" 
     id="permissionViewModal" 
     tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Permission Details: <span x-text="permissionsModule.viewingPermission.display_name || permissionsModule.viewingPermission.name"></span></h5>
                <button type="button" class="btn-close" @click="permissionsModule.closePermissionViewModal()"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <h6>Permission Information</h6>
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Name:</strong></td>
                                <td><code x-text="permissionsModule.viewingPermission.name"></code></td>
                            </tr>
                            <tr>
                                <td><strong>Display Name:</strong></td>
                                <td x-text="permissionsModule.viewingPermission.display_name || permissionsModule.viewingPermission.name"></td>
                            </tr>
                            <tr>
                                <td><strong>Resource:</strong></td>
                                <td>
                                    <span class="badge bg-primary" x-text="permissionsModule.viewingPermission.resource"></span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Action:</strong></td>
                                <td>
                                    <span class="badge" 
                                          :class="`bg-${permissionsModule.getActionBadgeClass(permissionsModule.viewingPermission.action)}`"
                                          x-text="permissionsModule.viewingPermission.action"></span>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6>Usage Statistics</h6>
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Roles with this permission:</strong></td>
                                <td>
                                    <span class="badge bg-info" x-text="permissionsModule.viewingPermission.roles_count || 0"></span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Created:</strong></td>
                                <td x-text="permissionsModule.viewingPermission.created_at ? new Date(permissionsModule.viewingPermission.created_at).toLocaleDateString() : 'Unknown'"></td>
                            </tr>
                            <tr>
                                <td><strong>Last Updated:</strong></td>
                                <td x-text="permissionsModule.viewingPermission.updated_at ? new Date(permissionsModule.viewingPermission.updated_at).toLocaleDateString() : 'Unknown'"></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div x-show="permissionsModule.viewingPermission.description" class="mb-3">
                    <h6>Description</h6>
                    <p class="text-muted" x-text="permissionsModule.viewingPermission.description"></p>
                </div>

                <div x-show="permissionsModule.viewingPermission.roles && permissionsModule.viewingPermission.roles.length > 0" class="mt-3">
                    <h6>Roles with this Permission</h6>
                    <div class="border rounded p-3" style="max-height: 200px; overflow-y: auto;">
                        <template x-for="role in permissionsModule.viewingPermission.roles" :key="role.id">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <strong x-text="role.display_name || role.name"></strong>
                                    <br x-show="role.description"><small class="text-muted" x-text="role.description"></small>
                                </div>
                                <span class="badge bg-secondary" x-text="`${role.users_count || 0} users`"></span>
                            </div>
                        </template>
                    </div>
                </div>

                <div x-show="!permissionsModule.viewingPermission.roles || permissionsModule.viewingPermission.roles.length === 0" class="mt-3">
                    <h6>Roles with this Permission</h6>
                    <div class="alert alert-warning">
                        <em>This permission is not assigned to any roles.</em>
                    </div>
                </div>

                <div class="mt-3">
                    <h6>Permission Scope</h6>
                    <div class="alert alert-info">
                        <small>
                            <strong x-text="`${permissionsModule.viewingPermission.action?.charAt(0).toUpperCase()}${permissionsModule.viewingPermission.action?.slice(1)} Permission:`"></strong>
                            This permission allows users to <strong x-text="permissionsModule.viewingPermission.action"></strong> resources of type <strong x-text="permissionsModule.viewingPermission.resource"></strong>.
                            <span x-text="permissionsModule.getActionDescription(permissionsModule.viewingPermission.action)"></span>
                        </small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" @click="permissionsModule.closePermissionViewModal()">Close</button>
            </div>
        </div>
    </div>
</div> 