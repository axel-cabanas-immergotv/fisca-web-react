<!-- Role View Modal -->
<div class="modal fade" 
     x-show="rolesModule.showRoleViewModal" 
     x-transition:enter="fade-in" 
     x-transition:leave="fade-out" 
     id="roleViewModal" 
     tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Role Details: <span x-text="rolesModule.viewingRole.display_name || rolesModule.viewingRole.name"></span></h5>
                <button type="button" class="btn-close" @click="rolesModule.closeRoleViewModal()"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <h6>Role Information</h6>
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Name:</strong></td>
                                <td><code x-text="rolesModule.viewingRole.name"></code></td>
                            </tr>
                            <tr>
                                <td><strong>Display Name:</strong></td>
                                <td x-text="rolesModule.viewingRole.display_name || rolesModule.viewingRole.name"></td>
                            </tr>
                            <tr>
                                <td><strong>Description:</strong></td>
                                <td>
                                    <span x-show="rolesModule.viewingRole.description" x-text="rolesModule.viewingRole.description"></span>
                                    <em x-show="!rolesModule.viewingRole.description" class="text-muted">No description</em>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Created:</strong></td>
                                <td x-text="rolesModule.viewingRole.created_at ? new Date(rolesModule.viewingRole.created_at).toLocaleDateString() : 'Unknown'"></td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6>Usage Statistics</h6>
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Users with this role:</strong></td>
                                <td>
                                    <span class="badge bg-primary" x-text="rolesModule.viewingRole.users_count || 0"></span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Total Permissions:</strong></td>
                                <td>
                                    <span class="badge bg-info" x-text="rolesModule.getRolePermissionsCount()"></span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Last Updated:</strong></td>
                                <td x-text="rolesModule.viewingRole.updated_at ? new Date(rolesModule.viewingRole.updated_at).toLocaleDateString() : 'Unknown'"></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div x-show="rolesModule.viewingRole.permissions && rolesModule.viewingRole.permissions.length > 0" class="mt-3">
                    <h6>Permissions (<span x-text="rolesModule.viewingRole.permissions.length"></span>)</h6>
                    <div class="border rounded p-3" style="max-height: 300px; overflow-y: auto;">
                        <div x-html="rolesModule.renderPermissionsByResource()"></div>
                    </div>
                </div>

                <div x-show="!rolesModule.viewingRole.permissions || rolesModule.viewingRole.permissions.length === 0" class="mt-3">
                    <h6>Permissions</h6>
                    <div class="alert alert-warning">
                        <em>This role has no permissions assigned.</em>
                    </div>
                </div>

                <div x-show="rolesModule.viewingRole.users && rolesModule.viewingRole.users.length > 0" class="mt-3">
                    <h6>Users with this Role</h6>
                    <div class="border rounded p-3" style="max-height: 200px; overflow-y: auto;">
                        <template x-for="user in rolesModule.viewingRole.users" :key="user.id">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <strong x-text="`${user.first_name} ${user.last_name}`"></strong>
                                    <br><small class="text-muted" x-text="user.email"></small>
                                </div>
                                <span class="badge" 
                                      :class="user.status === 'active' ? 'bg-success' : 'bg-warning'"
                                      x-text="user.status"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" @click="rolesModule.closeRoleViewModal()">Close</button>
                <button type="button" 
                        class="btn btn-primary" 
                        @click="rolesModule.editRoleFromView()">Edit Role</button>
            </div>
        </div>
    </div>
</div> 